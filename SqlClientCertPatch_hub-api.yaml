spec:
  template:
    spec:
      containers:
        - name: api
          volumeMounts:
            - name: ansible-postgres-cert-volume
              mountPath: /var/lib/pulp/.postgresql/postgresql.crt
              readOnly: true
              subPath: tls.crt
            - name: ansible-postgres-cert-volume
              mountPath: /var/lib/pulp/.postgresql/postgresql.key
              readOnly: true
              subPath: tls.key
      initContainers:
        - name: run-migrations
          volumeMounts:
            - name: ansible-postgres-cert-volume
              mountPath: /var/lib/pulp/.postgresql/postgresql.crt
              readOnly: true
              subPath: tls.crt
            - name: ansible-postgres-cert-volume
              mountPath: /var/lib/pulp/.postgresql/postgresql.key
              readOnly: true
              subPath: tls.key
        - name: resource-sync-job
          volumeMounts:
            - name: ansible-postgres-cert-volume
              mountPath: /var/lib/pulp/.postgresql/postgresql.crt
              readOnly: true
              subPath: tls.crt
            - name: ansible-postgres-cert-volume
              mountPath: /var/lib/pulp/.postgresql/postgresql.key
              readOnly: true
              subPath: tls.key
      volumes:
        - name: ansible-postgres-cert-volume
          secret:
            defaultMode: 0640
            secretName: ansible-postgres-cert
